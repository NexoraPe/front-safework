<div class="custom-card">

  <div class="card-header">
    <div class="status-badge" [class]="getBadgeClass(assignment.status)">
      <span class="status-dot"></span>
      {{ assignment.status }}
    </div>

    <div class="header-actions">
      @if (canStart()) {
      <button mat-flat-button class="btn-primary-custom" (click)="start.emit(assignment.incidentId)">
        Start Task
      </button>
      }

      @if (canClose()) {
      <button mat-flat-button class="btn-warn-custom" (click)="requestClose.emit(assignment)">
        Mark as Done
      </button>
      }

      @if (assignment.status === 'CLOSED') {
      <button mat-stroked-button (click)="editDocument.emit(assignment)">
        Edit Proof
      </button>
      }
    </div>
  </div>

  <div class="card-body">
    <h3 class="incident-title">Incident #{{assignment.incidentId}}</h3>

    <p class="incident-description">
      {{ assignment.incidentTitle }}
    </p>

    <div class="priority-wrapper">
      <button mat-button [matMenuTriggerFor]="priorityMenu" class="priority-btn"
        [class]="'priority-' + assignment.priority.toLowerCase()">
        <mat-icon class="alert-icon">warning</mat-icon>
        Priority: <strong>{{ assignment.priority }}</strong>
      </button>

      <mat-menu #priorityMenu="matMenu">
        <button mat-menu-item (click)="changePriority.emit('HIGH')">ðŸ”´ HIGH</button>
        <button mat-menu-item (click)="changePriority.emit('MEDIUM')">ðŸŸ¡ MEDIUM</button>
        <button mat-menu-item (click)="changePriority.emit('LOW')">ðŸŸ¢ LOW</button>
      </mat-menu>
    </div>
  </div>

  <div class="card-divider"></div>

  <div class="card-footer">
    <div class="date-info">
      <mat-icon class="calendar-icon">calendar_today</mat-icon>
      <div class="date-text">
        <span class="label">ASSIGNED:</span>
        <span class="value">{{ assignment.assignedAt | date:'mediumDate' }}, {{ assignment.assignedAt | date:'shortTime'
          }}</span>
      </div>
    </div>
  </div>

</div>